<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SCC Documentation</title>
    <style>
        body {
            width: 50%;
            margin: auto;
            background-color: whitesmoke;
        }
        .svmcall, .label {
            font-family: monospace;
            background-color: wheat;
            padding: 5px;
            margin-top: 30px;
        }
        .label {
            background-color: rgb(245, 200, 179);
        }
        .struct {
            border-collapse: collapse;
            width: 100%;
            font-family: monospace;
        }
        .struct th, td {
            border: 1px solid #000000;
            padding: 8px;
            text-align: left;
        }
        .struct tr:nth-child(even) {
            background-color: rgb(236, 236, 236);
        }
        .struct tr:hover {
            background-color: rgb(255, 255, 202);
        }
        .byte_list tr td:first-child, th:first-child {
            width: 10%;
        }
    </style>
</head>
<body>
    <h1>
        Salt Compiled Code (scc3) documentation
    </h1>

    <hr>
    <p>
        The Salt programming langauge is compiled to a SCC file before it gets executed, to
        increase execution speeds and stability, because the compiled does a lot of validation
        checks. This is the list of all current svm calls & labels.
        <br>
        Each SVM call (instruction), label & constant string is seperated with the <code>0x0a</code>
        byte, also being the newline ASCII char. In order to still have access to the newline, all
        <code>0x0a</code> bytes in strings must be replaced with <code>0x11</code> bytes, which
        will then get converted to newlines.
        <br>
        Important note: <b>all object IDs created by the user must start from <code>0800 0000</code>
        (8)</b>. The first 8 object IDs are reserved by the SVM. Assigning an object to these
        reserved IDs may cause unexpected problems.
    </p>
    
    <h2>SCC Header</h2>
    <p>
        This 64-byte header is located at the beginning of every SCC file, contaning crucial 
        information such as the SCC format version, the magic number, the amount of instructions
        or const strings. Without it, executing Salt would be a lot harder.
    </p>

    <div id="s_header">
        <table class="struct">
            <tr>
                <th>Offset</th>
                <th>Bytes</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td><code>0</code></td>
                <td><code>7f53 4343 ffee 0000</code></td>
                <td>
                    <code>SCC_HEADER</code>: magic string, indicates that this is indeed a SCC file.
                </td>
            </tr>
            <tr>
                <td><code>8</code></td>
                <td><code>0300 0000 0000 0000</code></td>
                <td>
                    <code>SCC_VERSION</code>: format version
                </td>
            </tr>
            <tr>
                <td><code>16</code></td>
                <td><code>xxxx xxxx 0000 0000</code></td>
                <td>
                    amount of instructions for allocating memory efficiently
                </td>
            </tr>
            <tr>
                <td><code>24</code></td>
                <td><code>0000 0000 0000 0000<br>0000 0000 0000 0000<br>0000 0000 0000 0000<br>0000 0000 0000 0000</code></td>
                <td>
                    none
                </td>
            </tr>
            <tr>
                <td><code>56</code></td>
                <td><code>7f7a 7b7c xxxx xx0a</code></td>
                <td>
                    compiler signature
                </td>
            </tr>
            
        </table>    
    </div>
    
    <h2>Base types</h2>
    <p>
        These are the basic types the SVM currently accepts.
    </p>

    <div id="s_type">
        <h2 class="wheat"></h2>
        <table class="struct byte_list">
            <tr>
                <th>Byte</th>
                <th>Type</th>
            </tr>
            <tr>
                <td>0x00</td>
                <td>null</td>
            </tr>
            <tr>
                <td>0x01</td>
                <td>int</td>
            </tr>
            <tr>
                <td>0x02</td>
                <td>float</td>
            </tr>
            <tr>
                <td>0x03</td>
                <td>bool</td>
            </tr>
            <tr>
                <td>0x04</td>
                <td>string</td>
            </tr>
            <tr>
                <td>0x80</td>
                <td>array</td>
            </tr>
        </table>
    </div>

    <br><hr>

    <h2>Labels</h2>

    <div id="s_$__init__">
        <h2 class="label">@$__INIT__</h2>
        <p>
            Starting point of the program. This is called a label, which the Virtual
            Machine can jump to. The initial dollar ($) sign makes the label a unique
            label which there can only be one of.
        </p>
    </div>
    
    <div id="s_$__end__">
        <h2 class="label">@$__END__</h2>
        <p>
            End label. When the SVM hits this line, it calls <code>core_clean()</code> and exits the program.
        </p>
    </div>

    <div id="s_else">
        <h2 class="label">@ELSE</h2>
        <p>
            This label shows the next closes jump-to location if the if statement returns
            false. This is used in the virtual machine to make quick and efficient jumps
            to a further point in code, because all the locations of the else tags are
            preloaded before execution. This allows to use a binary search algorithm to
            find the closest jump.
        </p>
    </div>

    <hr>
    <h2>SVM Calls</h2>
    <p>
        This is a list of SVM calls you can make in the latest format.
    </p>


    <div id="s_vmake">
        <h2 class="svmcall">RMAKE id</h2>
        <p>
            Print the object value
        </p>
        <table class="struct">
            <tr>
                <td>xxxx xxxx</td>
            </tr>
            <tr>
                <td>uint id: object id</td>
            </tr>
        </table>
    </div>


    <div id="s_print">
        <h2 class="svmcall">PRINT id</h2>
        <p>
            Print the object value
        </p>
        <table class="struct">
            <tr>
                <td>xxxx xxxx</td>
            </tr>
            <tr>
                <td>uint id: object id</td>
            </tr>
        </table>
    </div>

    <footer style="height: 100px;"></footer>

</body>
</html>